<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curso de C#</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- <li id="$(index)">$(el)</li> -->
    <h1>Curso de CSharp</h1>
    <h2>Indice Tematico</h2>
    <ul>
        <li><a href="cursoCsharp.html#referencia">Referencias</a></li>
        <li><a href="cursoCsharp.html#instalacion">Instalacion</a></li>
        <li><a href="cursoCsharp.html#consola-vstudio">creacion de un proyecto de consola desde visual studio Code</a></li>
        <li><a href="cursoCsharp.html#atajos">atajos del teclado en visual studio</a></li>
        <li><a href="cursoCsharp.html#ruta">Ruta de aprendizaje </a></li>
        <li><a href="cursoCsharp.html#basico-array">Array</a></li>
        <li><a href="cursoCsharp.html#configurar">Configurar DotNet-ef</a></li>
        <li><a href="cursoCsharp.html#ejercicios_dotnet_ef">ejercicios DotNet-ef</a></li>
        <li><a href="cursoCsharp.html#db_context">Creacion de DBContext</a></li>
        <li><a href="cursoCsharp.html#migracion">migracion de Base de Datos</a></li>
        <li><a href="cursoCsharp.html#cambiar_campo">Cambiar tamaño del campo en la entidad</a></li>
        <li><a href="cursoCsharp.html#generar_key">Como generar una key que usaremos como base para los token desde SQLServer</a></li>
        <li><a href="cursoCsharp.html#ncapas">Manejo de NCapas</a></li>
        <li><a href="cursoCsharp.html#webapi_first_data">Web Api primero la base de datos + JWT</a></li>


    </ul>


    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="referencia">Referencias</h2>
    <article>
        tomaremos como referencias el curso de Entity Framework Core de NetMentor <a
            href="https://www.youtube.com/watch?v=4azrTdMtaO4&list=PLesmOrW3mp4i2RdfsPI5R6o5EVacGuovz" target="_blank">EFCore</a>. <br>
        Tambien podemos ver un blog donde explica un poco mas <a
            href="https://www.netmentor.es/entrada/database-first" target="_blank">blog</a>
        para crear un proyecto desde la consola hay que ejecutar los siguientes pasos: <br>
        Tambien encontre unos videos muy buenos de JWT con EF Core: 
        <a href="https://www.youtube.com/watch?v=i3trcykG7bU&t=336s" target="_blank" rel="noopener noreferrer">Web API codigo estudiante</a> <br>
        LA documentacion oficial de EntityFrameworkCore <a href="https://www.entityframeworktutorial.net/efcore/fluent-api-in-entity-framework-core.aspx" 
        target="_blank" rel="noopener noreferrer">EntityFrameworkCore</a> <br>
        la pagina oficial de Microsoft es <a href="https://learn.microsoft.com/es-es/dotnet/core/tutorials/" target="_blank" rel="noopener noreferrer">Tutoriales Microsoft</a> <br>
        
    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="instalacion">inatalacion</h2>
    <article>
        Es posible programar con c# desde visual studio Code, para esto necesitamos instalar el SDK de netCore desde la pagina: 
        <a href="https://dotnet.microsoft.com/es-es/download/dotnet/thank-you/sdk-8.0.408-windows-x64-installer" target="_blank" rel="noopener noreferrer">SDK net core 8</a> <br>
        que es la version estable STL, ademas debemos instalar los siguientes paquetes: <br>
        paquete <strong>C# Dev Kit</strong> en la busqueda se escribe simplemente <strong>c#</strong> <br>
        extensiones adicionales para los snippets <strong>C# Extensions JosKreativ (para snippets y helpers adicionales).</strong> <br>


    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="consola-vstudio">proyecto de consola desde visual studio Code</h2>
    <article>
        para crea un proyecto de consola desde visual studio code abrimos la teminal y escribimos: <br>
        <pre>
            dotnet new console -n MiProyectoConsola
        </pre>
        para ejecutar el proyecto entro a la carpeta con cd MiProyectoConsola y escribo <strong>dotnet run </strong> <br>
        
    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="atajos">Atajos de teclado en visual Studio</h2>
    <article>
        <table>
            <thead>
                <tr>
                    <th>Combinacion del teclado </th>
                    <th>Resultado </th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>cw + tab</td>
                    <td>Console.WriteLine();</td>
                </tr>
                <tr>
                    <td>ctor + tab</td>
                    <td>Genera un contructor vacio de la clase;</td>
                </tr>
                <tr>
                    <td>prop + tab</td>
                    <td>Genera propiedad de clases ;</td>
                </tr>
                <tr>
                    <td>propfull + tab</td>
                    <td>Genera propiedad con su campo de respaldo get y set ;</td>
                </tr>
            </tbody>
        </table>

    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="ruta">Ruta de aprendizaje</h2>
    <article>
        Esta es la ruta de aprendizaje para convertirse en Back End, recomendada por Hector de Leon 
        <a href="https://hdeleon.net/roadmap-programador-backend-net/" target="_blank" rel="noopener noreferrer">Roadmap </a> 
        Tambien existe esta otra ruta <a href="https://www.youtube.com/watch?v=xTIv_rkaWE4" target="_blank" rel="noopener noreferrer">The coder Cave</a>
    </article>


    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="basico-array">Array</h2>
    <article>
        Los array o arreglos son colecciones de datos de un mismo tipo, tiene un tamaño fijo y los elemento se puede acceder por su indice  : <br>
        <pre>
            int[] numeros = new int[3] ; //defininos una array de numeros tipo numero 
            numeros[0]=10 ;
            numeros[1]=20 ;
            numeros[2]=30 ;
        </pre>    
        Tambien podemos declaralo e inicializarlo en una sola linea de la siguiente forma: <br>
        <pre>
            int[] numeros2 = new int[3] { 40, 50, 60 };

            foreach (var item in numeros2)
            {
                System.Console.WriteLine(item);
            }
        </pre>    
        Cuando expecificamos el tipo del array al momento de definirlo se llama array explecito  pero tambien existe los 
        array implicito donde el compilador es el que determina que tipo de array es, para esto se utiliza el comando <strong>Var</strong>,
        en el lugar del tipo de array ejemplo : <br>
        <pre>
            Console.WriteLine("Array implicito");
            var numeros3 = new[] { 60, 70, 80 };
        </pre>
        Que aporta los array implicitos, en caso que se define un array como entero y en el llenado se coloca un valor con decimal, 
        el C# arroja en error al tratar de convertir el tipo de datos <br>
        en cambio con el array implicito no sucede esto.
        <pre>
                 int[] numeros2 = new int[3] { 40, 50, 60.25 };
        </pre> 
        <strong>Array de Objetos</strong>, ahora crearemos una clase Empleado que tiene un contructor que recibe nombre y edad. <br>
        <pre>
        public class Empleado
        {
            public string Nombre { get; }
            public int Edad { get; }

            public Empleado(string nombre, int edad)
            {
                Nombre = nombre;
                Edad = edad;
            }
        }
        </pre>
        creamos un array de objeto de la clase Empleado y agregamos nuestro primer objeto al arrary . <br>
        <pre>
            Empleado[] arrayEmpleado = new Empleado[2];
            arrayEmpleado[0] = new Empleado("rondey", 50);
        </pre>
        Tambien podemos crear una instancia de Empleado con el objeto Cecilia y luego lo agregamos dentro del array de Objetos <br>
        <pre>
            //otra forma de crear primero una instanncia de la clase empleado y luego se agrega al array de objetos.
            Empleado() ceci = new Empleado("cecilia", 37);
            arrayEmpleado[1] = ceci;
        </pre>
        <strong>Array de tipos o clase anonimas</strong> en que casos usamos clase anonimas : <br>
        
        <ul>
            <li>Cuando necesitas retornar o manejar un conjunto de propiedades solo temporalmente.</li>
            <li>En consultas LINQ para proyectar solo algunos campos.</li>
            <li>Cuando no necesitas métodos, solo propiedades.</li>
            <li>No necesitas reutilizar el tipo en otro lugar del código.</li>
        </ul>
        Uso basico:
        <pre>
            var persona = new { Nombre = "Juan", Edad = 25 };
            Console.WriteLine($"Nombre: {persona.Nombre}, Edad: {persona.Edad}");
        </pre>
        uso en una Lista:
        <pre>
            var personas = new[]
            {
                new { Nombre = "Ana", Edad = 28 },
                new { Nombre = "Luis", Edad = 35 }
            };

            foreach (var p in personas)
            {
                Console.WriteLine($"{p.Nombre} - {p.Edad}");
            }

        </pre>
        En una consulta LINQ.
        <pre>
            var empleados = new[]
            {
                new { Nombre = "Pedro", Edad = 45, Area = "Ventas" },
                new { Nombre = "Laura", Edad = 32, Area = "TI" }
            };

            var resultado = empleados
                .Where(e => e.Edad > 40)
                .Select(e => new { e.Nombre, e.Area });

            foreach (var r in resultado)
            {
                Console.WriteLine($"{r.Nombre} trabaja en {r.Area}");
            }

        </pre>
        Agrupamos datos temporalmente. 
        <pre>
            string nombre = "Carlos";
            int salario = 3000;

            var info = new { nombre, salario }; // se infiere el nombre de las propiedades desde las variables

            Console.WriteLine($"{info.nombre} gana {info.salario} USD");

        </pre>
    </article>
    <strong>pasar un array como parametro</strong> consiste en enviar un array como pamaetro a un metodo ejemplo: <br>
    <pre>
        Console.WriteLine("enviar array como parametro a un metodo");
        string[] cliente = { "cecilia", "lucila", "yari" };
        ConsultarCliente(cliente);

        static void ConsultarCliente(string[] cli) 
        {
            foreach (var item in cli)
            {
                System.Console.WriteLine(item);
            }
        }
    </pre>
    Tambien podemos para un objeto como parametros por ejemplo tenemos la clase Empleado.cs llenamos los valores y lo 
    pasamos como parametros al metodo MostrarPerosona() <br>
    <pre>
        Empleado[] empleados = new Empleado[3];
        empleados[0] = new Empleado("cecilia", 37);
        empleados[1] = new Empleado("juan", 17);
        empleados[2] = new Empleado("samuel", 9);

        MostrarEmpleado(empleados);

        static void MostrarEmpleado(Empleado[] lista)
        {
            foreach (var emp in lista)
            {
                System.Console.WriteLine($"{emp.Nombre} y edad {emp.Edad}");
            }
        }

    </pre>
    podemos observar que lo cambia en donde decia tipo <strong>string[]</strong> ahora se coloca <strong>Empleado[]</strong> que es nuetro objeto <br>
    y cuando recibe el parametro dentro del mentodo tambien se hace el mismo cambio. <br>
    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="configurar">Configurar DotNet-ef</h2>

    <h3 id="instalacion_dotnet_ef">1. Instalamos en dotnet-ef</h3>
    <article>
        para instalarlo usamos el comando desde el teminal o por cmd: <br>
        <strong>dotnet tool install --global dotnet-ef</strong> <br>

        para actualizar la version debemos usar el comando: <br>
        <strong>dotnet tool update --global dotnet-ef</strong><br>

    </article>

    <h3 id="instalacion_dotnet_ef">2. Creamos un proyecto WebApi</h3>
    <article>
        Escogemos nuevo proyecto y escibimos en la busqueda <strong>WebApi</strong><br>
    </article>

    <h3 id="adicionamos_ec_al_proyecto">3. añadimos el paquete Microsoft Entity Core a proyecto</h3>
    <article>
        Si estamos trabajando en Visual Studio comunitive nada mas hay que instalar
        <strong>EntityFrameworkCore.Tools</strong>, de la siguiente forma: <br>
        <strong>Install-Package Microsoft.EntityFrameworkCore.Tools</strong><br><br>

        si esta usando visual studio Code, debe adicionar el paquete <strong>EntityFrameworkCore.Design</strong>, en
        Comunitive no es necesario agregarlo,
        y se realiza de la siguiente forma: <br>

        para añadir el paquete no me funcionó escogiendo desde el administrador NuGet, tuve que hacerlos desde
        consola: <br>
        Ve a Herramientas > Administrador de paquetes NuGet > Consola del Administrador de paquetes. <br>
        despues ejecute el siguiente comando: <br>
        <strong>Install-Package Microsoft.EntityFrameworkCore.Design -Version 9.0.0</strong> <br>
    </article>

    <h3 id="adicionamos_sqlserver">4. añadimos el paquete Sqlserver a proyecto</h3>
    <article>
        y para el driver de Sqlserver me tocó instalar: <br>
        <strong>Install-Package Microsoft.EntityFrameworkCore.SqlServer -Version 9.0.0</strong> <br><br>
    </article>

    <h3 id="adicionamos_consexion_sqlserver">5. añadimos cadena de conexion</h3>
    <article>
        Esto hay que ejecutarlo desde cmd: <br>
        dotnet ef dbcontext scaffold "Server=192.168.50.6;Database=PRUEBA;User
        Id=sa;Password=Clave01.;Trusted_Connection=False;MultipleActiveResultSets=True;"
        Microsoft.EntityFrameworkCore.SqlServer -o Models <br>
    </article>


    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="db_context">Creacion de DbContext</h2>
    <article>
        <h3>creamos el DBContext</h3>
        <pre>
            public class ApplicationDbContext:DbContext
            {
                public ApplicationDbContext(DbContextOptions options) : base(options) 
                { 
        
                }
        
                protected override void OnModelCreating(ModelBuilder modelBuilder)
                {
                    base.OnModelCreating(modelBuilder);
        
                    //modelBuilder.Entity<Genero>().HasKey(x => x.Id);
                    modelBuilder.Entity<Genero>().Property(x => x.Nombre).HasMaxLength(150);
                }
        
                public DbSet&lt;Genero> Generos => Set&lt;Genero>();
                    
        
            }
        
        </pre>
    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="migracion">Migracion de Base de datos</h2>
    <article>
        para ejecutar la migracion debemos escribir el siguiente comando en el adminitrador de paquetes:
        <br>
        <strong>Add-Migration Inicial</strong><br><br>

        para que se acualice la base de datos con los cambios que se haga en la entidad hay que escribir
        el siguiente comando: <br>
        <strong>update-database</strong><br>
    </article>


    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="cambiar_campo">cambiar tamaño campo en la entidad</h2>
    <article>
        vamos a crear el tamaño del campo nombre que pase a 150, actualmente está en Max_length, <br>
        Esto se puede hacer dentro del DBContext como en el ejemplo anterior o se puede cuando se crea la clase de la
        entidad,
        colocando la anotacion <strong>[StringLength(maximumLength:150)]</strong>

        <pre>
            public class Genero
            {
                public int Id { get; set; }
                [StringLength(maximumLength:150)]
                public string Nombre { get; set; } = null!;
            }
        </pre>

        Crearemos una nueva migracion con el nombre <strong>GeneroNombre</strong> de la siguiente forma: <br>
        <strong>Add-Migration GeneroNombre</strong><br><br>

        sale un mensaje de advertencia porque se pueden perder datos, ya que estamos disminuyendo el tamaña del campo.
        pero si estamos seguros hay que escribir el siguiente comando para confirmar los cambios: <br><br>

        <strong>update-database</strong><br>

        si no estas dentro del administrador de paquetes del proyecto o estas usando visual studio code, entoces tienes
        que
        hacerlo desde cmd, y el comando seria: <br>
        <strong>dotnet ef database update</strong>

    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="generar_key">Generar key como base para nuestro Token usando Sql</h2>
    <article>
        para usar JWT debemos proporcionar como base un key que debe tener como minimo 32 caracteres para que sea segura,
        nos podemos ayudar usando SQL. <br>
        <pre>
            select newid()
            select len('8993CF08-903B-4BFC-994D-7297AB295914')
        </pre>
        En mi caso me genero una key de 36 caracteres. <br>

    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="ncapas">Manejo de NCapas</h2>
    <article>
       Lo primero que dedemos hacer es crar un solucion en blanco, que será la encargada de contener los diferentes proyectos de cada Capa. <br>
       asi que abrimos nuevo proyecto y en la busqueda escribimos <strong>solu</strong> para crear la solucion vacia. <br>
       las capas pueden ser proyectos tipos bibliotecas, <br>
       entonces con el boton derecho le damos apregar proyecto tipo bibioteca de clases y le ponemos como nombre <strong>ProyectoModelo</strong>,
       <strong>ProyectoData</strong>, <br>
       ahora agregamos un proyecto llamanda <strong>ProyectoWebApi</strong> este proyecto es tipo <strong>WebApi</strong> <br>


    </article>

    <a href="cursoCSharp.html">⏫</a>
    <hr>
    <h2 id="webapi_first_data">Web Api primero la base de datos</h2>
    <article>
        el video instructivo del paso a paso se encuentra en <a href="https://www.youtube.com/watch?v=i3trcykG7bU&t=336s" target="_blank" rel="noopener noreferrer">net core + web api+ JWT</a> <br>
        pasos en sql server : <br>
        <ul>
            <li>Crear base de datos <strong>Servi_Erp</strong></li>
            <li>Crear tabla de usuario </li>
            <li>Crear tabla factura </li>
            <li>Crear tabla factura_detalle </li>
        </ul>

        pasos en visual studio Comnunitive : <br>
        <ul>
            <li>Crear un proyecto ASP NET core Web Api</li>
            <li><a href="cursoCsharp.html#instalar_paquete">instalar paquetes NuGet para EF y JWT</a></li>
            <li><a href="cursoCsharp.html#configurar_data_base">Configurar base de datos en carpeta Models</a></li>
            <li> </li>
            <li>Configurar conexions a base de datos y JWT en <strong>appsettings.json</strong> </li>
        </ul>

        <h2 id="instalar_paquete">instalamos paquetes Nuget</h2>
        <article>
            Nos ubicamos en la solucion con el boton derecho del mouse escogemos <strong>administrador de paquetes Nuget</strong> <br>
            escribimos dentro de la pestaña examinar <strong>entiy sqlserv</strong> para instalar el paquete <strong>Microsoft.EntityFrameworkCore.SqlServer</strong>,
            version 9.0.4 . <br>
            ahora escribimos <strong>entity tools</strong> para instalar el paquete <strong>Microsoft.EntityFrameworkCore.Tools</strong> version 9.0.4 <br>
            ahora esciibimos <strong>authentica</strong> para instalar el paquete <strong>Microsoft.AspNetCore.Authentication.JwtBeare</strong>
            version 8.0.15 <br> Esta es la version compatible con Net 8 , con la version 9.0.4 dice que debe ser la version net 9. <br>
        </article>

        <h2 id="configurar_data_base">Configurar base de datos en carpeta Models</h2>
        <article>
            Primero creamos una carpeta <strong>Models</strong> <br>
            Boton derecho del mouse y escogemos Agregar nueva carpeta y le ponemos el nombre de Models <br>
            ahora abrimos la consola desde visual estudio, <br>
            en el proyecto damos boton derecho y escogemos <strong>herramientas - administrador de paquetes Nuget - Consola administrador de paquetes</strong> - <br> 
            debe aparecer el promop <strong>PM</strong> y escribimos : <br>
            scaffold-DbContext "Server=PC127\\SQLEXPRESS;Database=servi_erp;User Id=sa;Password=Clave01.;TrustServerCertificate=True;" Microsoft.EntityFrameworkCore.SqlServer -o Models
            scaffold-DbContext "Server=localhost,61061;Database=servi_erp;User Id=sa;Password=Clave01.;TrustServerCertificate=True;" Microsoft.EntityFrameworkCore.SqlServer -o Models

        </article>

    </article>

</body>

</html>